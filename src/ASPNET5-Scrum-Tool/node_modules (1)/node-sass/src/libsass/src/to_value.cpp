#include "ast.hpp"
#include "to_value.hpp"
#include "to_string.hpp"

namespace Sass ***REMOVED***

  Value* To_Value::fallback_impl(AST_Node* n)
  ***REMOVED***
    // throw a runtime error if this happens
    // we want a well defined set of possible nodes
    throw std::runtime_error("invalid node for to_value");
    // mute warning
    return 0;
  ***REMOVED***

  // Custom_Error is a valid value
  Value* To_Value::operator()(Custom_Error* e)
  ***REMOVED***
    return e;
  ***REMOVED***

  // Custom_Warning is a valid value
  Value* To_Value::operator()(Custom_Warning* w)
  ***REMOVED***
    return w;
  ***REMOVED***

  // Boolean is a valid value
  Value* To_Value::operator()(Boolean* b)
  ***REMOVED***
    return b;
  ***REMOVED***

  // Number is a valid value
  Value* To_Value::operator()(Number* n)
  ***REMOVED***
    return n;
  ***REMOVED***

  // Color is a valid value
  Value* To_Value::operator()(Color* c)
  ***REMOVED***
    return c;
  ***REMOVED***

  // String_Constant is a valid value
  Value* To_Value::operator()(String_Constant* s)
  ***REMOVED***
    return s;
  ***REMOVED***

  // String_Quoted is a valid value
  Value* To_Value::operator()(String_Quoted* s)
  ***REMOVED***
    return s;
  ***REMOVED***

  // List is a valid value
  Value* To_Value::operator()(List* l)
  ***REMOVED***
    List* ll = SASS_MEMORY_NEW(mem, List,
                               l->pstate(),
                               l->length(),
                               l->separator(),
                               l->is_arglist());
    for (size_t i = 0, L = l->length(); i < L; ++i) ***REMOVED***
      *ll << (*l)[i]->perform(this);
***REMOVED***
    return ll;
  ***REMOVED***

  // Map is a valid value
  Value* To_Value::operator()(Map* m)
  ***REMOVED***
    return m;
  ***REMOVED***

  // Null is a valid value
  Value* To_Value::operator()(Null* n)
  ***REMOVED***
    return n;
  ***REMOVED***

  // Argument returns its value
  Value* To_Value::operator()(Argument* arg)
  ***REMOVED***
    if (!arg->name().empty()) return 0;
    return arg->value()->perform(this);
  ***REMOVED***

  // Selector_List is converted to a string
  Value* To_Value::operator()(Selector_List* s)
  ***REMOVED***
    To_String to_string(&ctx);
    return SASS_MEMORY_NEW(mem, String_Quoted,
                           s->pstate(),
                           s->perform(&to_string));
  ***REMOVED***

  // Binary_Expression is converted to a string
  Value* To_Value::operator()(Binary_Expression* s)
  ***REMOVED***
    To_String to_string(&ctx);
    return SASS_MEMORY_NEW(mem, String_Quoted,
                           s->pstate(),
                           s->perform(&to_string));
  ***REMOVED***

***REMOVED***;
