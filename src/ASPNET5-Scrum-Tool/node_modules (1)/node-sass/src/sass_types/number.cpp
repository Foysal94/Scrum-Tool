#include <nan.h>
#include "number.h"
#include "../create_string.h"

namespace SassTypes
***REMOVED***
  Number::Number(Sass_Value* v) : SassValueWrapper(v) ***REMOVED******REMOVED***

  Sass_Value* Number::construct(const std::vector<v8::Local<v8::Value>> raw_val, Sass_Value **out) ***REMOVED***
    double value = 0;
    char const* unit = "";

    if (raw_val.size() >= 1) ***REMOVED***
      if (!raw_val[0]->IsNumber()) ***REMOVED***
        return fail("First argument should be a number.", out);
  ***REMOVED***

      value = Nan::To<double>(raw_val[0]).FromJust();

      if (raw_val.size() >= 2) ***REMOVED***
        if (!raw_val[1]->IsString()) ***REMOVED***
          return fail("Second argument should be a string.", out);
***REMOVED***

        unit = create_string(raw_val[1]);
  ***REMOVED***
***REMOVED***

    return *out = sass_make_number(value, unit);
  ***REMOVED***

  void Number::initPrototype(v8::Local<v8::FunctionTemplate> proto) ***REMOVED***
    Nan::SetPrototypeMethod(proto, "getValue", GetValue);
    Nan::SetPrototypeMethod(proto, "getUnit", GetUnit);
    Nan::SetPrototypeMethod(proto, "setValue", SetValue);
    Nan::SetPrototypeMethod(proto, "setUnit", SetUnit);
  ***REMOVED***

  NAN_METHOD(Number::GetValue) ***REMOVED***
    info.GetReturnValue().Set(Nan::New<v8::Number>(sass_number_get_value(unwrap(info.This())->value)));
  ***REMOVED***

  NAN_METHOD(Number::GetUnit) ***REMOVED***
    info.GetReturnValue().Set(Nan::New<v8::String>(sass_number_get_unit(unwrap(info.This())->value)).ToLocalChecked());
  ***REMOVED***

  NAN_METHOD(Number::SetValue) ***REMOVED***

    if (info.Length() != 1) ***REMOVED***
      return Nan::ThrowTypeError(Nan::New("Expected just one argument").ToLocalChecked());
***REMOVED***

    if (!info[0]->IsNumber()) ***REMOVED***
      return Nan::ThrowTypeError(Nan::New("Supplied value should be a number").ToLocalChecked());
***REMOVED***

    sass_number_set_value(unwrap(info.This())->value, Nan::To<double>(info[0]).FromJust());
  ***REMOVED***

  NAN_METHOD(Number::SetUnit) ***REMOVED***
    if (info.Length() != 1) ***REMOVED***
      return Nan::ThrowTypeError(Nan::New("Expected just one argument").ToLocalChecked());
***REMOVED***

    if (!info[0]->IsString()) ***REMOVED***
      return Nan::ThrowTypeError(Nan::New("Supplied value should be a string").ToLocalChecked());
***REMOVED***

    sass_number_set_unit(unwrap(info.This())->value, create_string(info[0]));
  ***REMOVED***
***REMOVED***
